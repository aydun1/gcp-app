
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 0" (click)="openCustomerPicker(cage.id)" [disabled]="loading" class="action">Assign to customer</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 1" (click)="markWithCustomer(cage.id)" [disabled]="loading" class="action">Deliver to customer</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 2" (click)="markAsCollected(cage.id)" [disabled]="loading" class="action">Collect from customer</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 3" (click)="markWithProcessing(cage.id)" [disabled]="loading" class="action">Send to local processing</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 3" (click)="markWithPolymer(cage.id)" [disabled]="loading" class="action">Send to Polymer</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 4" (click)="collectFromProcessing(cage.id, cage.fields.AssetType)" [disabled]="loading" class="action">Return from local processing</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 5" (click)="collectFromPolymer(cage.id, cage.fields.AssetType)" [disabled]="loading" class="action">Return from Polymer</button>
<button mat-raised-button type="button" color="primary" *ngIf="cage.statusId === 6" (click)="markAvailable(cage.id, cage.fields.CageNumber, cage.fields.Branch, cage.fields.AssetType, cage.fields.CageWeight)" [disabled]="loading" class="action">Set cage as available</button>
<button mat-icon-button type="button" [matMenuTriggerFor]="menu" class="menu" *ngIf="!cage.statusId || cage.statusId < 7"><mat-icon>more_vert</mat-icon></button>
<mat-menu #menu="matMenu" xPosition="before">
  <ng-template matMenuContent>
    <button type="button" mat-menu-item (click)="undo(cage.id, cage.fields.Status)" [disabled]="cage.statusId === 0">
      <mat-icon>undo</mat-icon>
      <span>Undo</span>
    </button>
    <button type="button" mat-menu-item (click)="reset(cage.id)" [disabled]="cage.statusId === 0">
      <mat-icon>restart_alt</mat-icon>
      <span>Reset</span>
    </button>
    <button type="button" mat-menu-item (click)="dehire(cage.id)" [disabled]="cage.statusId !== 0">
      <mat-icon>assignment_return</mat-icon>
      <span>Dehire</span>
    </button>
    <button type="button" mat-menu-item [matMenuTriggerFor]="branchesMenu">
      <mat-icon>location_city</mat-icon>
      <span>Change branch</span>
    </button>
    <button type="button" mat-menu-item [matMenuTriggerFor]="depotMenu" [disabled]="cage.statusId !== 0">
      <mat-icon>local_shipping</mat-icon>
      <span>Transfer to depot</span>
    </button>
  </ng-template>
</mat-menu>

<mat-menu #branchesMenu="matMenu">
  <button type="button" *ngFor="let branch of branches" mat-menu-item (click)="setBranch(cage.id, branch)" [disabled]="branch === cage.fields.Branch">{{ branch }}</button>
</mat-menu>

<mat-menu #depotMenu="matMenu">
  <button type="button" *ngFor="let depot of depots" mat-menu-item (click)="setDepot(cage.id, depot.fields.Title)">{{ depot.fields.Title }}</button>
  <button mat-menu-item (click)="openSiteDialog(cage.fields.Branch)">
    <mat-icon>add</mat-icon>
    <span>Add/edit depots</span>
  </button>
</mat-menu>