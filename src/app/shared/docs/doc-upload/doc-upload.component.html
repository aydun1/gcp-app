<div (dragover)="allowDrop($event)" (drop)="drop($event)">
  <div for="file" class="image-upload-preview">
    <input #fileSelect class="file-select" multiple="multiple" type="file" (change)="fileChangeEvent(id, $event)">
    <label class="label" for="file">
      <button mat-button type="button" class="drag-info" (click)="fileSelect.click()">Attach a document</button>
    </label>
  </div>
</div>

<mat-nav-list>
  <div class="doc" *ngFor="let doc of docs$ | async">
    <a mat-list-item [href]="doc.webUrl" target="_blank">
      <img *ngIf="doc.file; else loading" [src]="icon(doc.file.mimeType)" mat-list-icon>
      <div mat-line>{{ doc.name }}</div>
      <div mat-line *ngIf="doc.createdBy else loading2">Uploaded by {{ doc.createdBy.user.displayName }} on {{ doc.createdDateTime | date: 'dd/MM/yyyy hh:mm a' }} </div>
      <ng-template #loading2>
        <div mat-line>{{ doc.percent || 0 }}% </div>
      </ng-template>
    </a>
    <button mat-icon-button class="menu-toggle" type="button" [matMenuTriggerFor]="menu" [matMenuTriggerData]="{doc: doc}"><mat-icon>more_vert</mat-icon></button>
  </div>
</mat-nav-list>

<ng-template #loading>
  <mat-spinner mat-list-icon diameter="24"></mat-spinner>
</ng-template>


<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-doc="doc">
    <button mat-menu-item (click)="downloadFile(doc.name, doc['@microsoft.graph.downloadUrl'])">
      <mat-icon>download</mat-icon>
      <span>Download</span>
    </button>
    <button mat-menu-item (click)="deleteFile(doc.name)">
      <mat-icon>delete</mat-icon>
      <span>Delete</span>
    </button>
  </ng-template>
</mat-menu>
