<div class="outer">
  <div class="options inner">
    <mat-form-field appearance="outline" class="region-filter">
      <mat-label>Select Territory</mat-label>
      <mat-select [formControl]="territoryFilter" (selectionChange)="setRegion($event)">
        <mat-option *ngFor="let t of territories" value="{{ t }}">{{ t }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="name-filter">
      <mat-label>Find by name</mat-label>
      <input matInput [formControl]="nameFilter" type="text" autocomplete="off" placeholder="Type to search...">
      <button *ngIf="!nameFilter.value" matSuffix mat-icon-button disabled type="button">
        <mat-icon>search</mat-icon>
      </button>
      <button *ngIf="nameFilter.value" matSuffix mat-icon-button aria-label="Clear" (click)="clearNameFilter()" type="button">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>

    <mat-form-field appearance="outline" class="pallet-filter">
      <mat-label>Pallets</mat-label>
      <mat-select [formControl]="palletsFilter" multiple (selectionChange)="setPallets($event)">
        <mat-option value="loscam">Loscam</mat-option>
        <mat-option value="chep">Chep</mat-option>
        <mat-option value="plain">Plain</mat-option>
      </mat-select>
    </mat-form-field>
  </div>

  <div *ngIf="(customers$ | async) as customers" class="inner">
    <mat-table #table [dataSource]="customers" [trackBy]="trackByFn" matSort [matSortActive]="sortSort" [matSortDirection]="sortOrder" (matSortChange)="announceSortChange($event)">
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Name </mat-header-cell>
        <mat-cell *matCellDef="let customer" [routerLink]="[customer.accountnumber]">
          <a [routerLink]="[customer.accountnumber]" class="customer-link">{{customer.name}}</a>
        </mat-cell>
        <mat-footer-cell *matFooterCellDef>Total</mat-footer-cell>
      </ng-container>
      <ng-container matColumnDef="loscam">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Loscams </mat-header-cell>
        <mat-cell *matCellDef="let customer"> {{customer.new_pallets_loscam || 0}} </mat-cell>
        <mat-footer-cell *matFooterCellDef>{{ loscams }}</mat-footer-cell>
      </ng-container>
      <ng-container matColumnDef="chep">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Cheps </mat-header-cell>
        <mat-cell *matCellDef="let customer"> {{customer.new_pallets_chep || 0}} </mat-cell>
        <mat-footer-cell *matFooterCellDef>{{ cheps }}</mat-footer-cell>
      </ng-container>
      <ng-container matColumnDef="plain">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Plains </mat-header-cell>
        <mat-cell *matCellDef="let customer"> {{customer.new_pallets_plain || 0}} </mat-cell>
        <mat-footer-cell *matFooterCellDef>{{ plains }}</mat-footer-cell>
      </ng-container>
      <ng-container matColumnDef="accountnumber">
        <mat-header-cell *matHeaderCellDef> Account number </mat-header-cell>
        <mat-cell *matCellDef="let customer"> {{customer.accountnumber}} </mat-cell>
        <mat-footer-cell *matFooterCellDef></mat-footer-cell>
      </ng-container>
      <ng-container matColumnDef="loading">
        <mat-footer-cell *matFooterCellDef>
          <gcp-loading-row></gcp-loading-row>
        </mat-footer-cell>
      </ng-container>
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
      <mat-footer-row *matFooterRowDef="['loading']" [class.hidden]="(loading | async) ? false : true"></mat-footer-row>
      <mat-footer-row *matFooterRowDef="displayedColumns"></mat-footer-row>
    </mat-table>
  </div>
</div>
<router-outlet></router-outlet>